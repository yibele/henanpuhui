<!--
  新增农户页面（签约农户）
  录入农户签约信息
-->
<view class="add-farmer-page">
  <!-- 基本信息 -->
  <view class="form-section">
    <view class="section-header">
      <view class="section-indicator section-indicator-green"></view>
      <text class="section-title">基本信息</text>
    </view>
    
    <view class="form-card">
      <!-- 姓名 -->
      <view class="form-item">
        <text class="form-label required">农户姓名</text>
        <input 
          class="form-input"
          placeholder="输入农户姓名"
          value="{{form.name}}"
          bindinput="onNameInput"
        />
      </view>
      
      <view class="form-divider"></view>
      
      <!-- 电话 -->
      <view class="form-item">
        <text class="form-label required">联系电话</text>
        <input 
          class="form-input"
          type="number"
          maxlength="11"
          placeholder="输入11位手机号"
          value="{{form.phone}}"
          bindinput="onPhoneInput"
        />
      </view>
      
      <view class="form-divider"></view>
      
      <!-- 身份证号 -->
      <view class="form-item">
        <text class="form-label required">身份证号</text>
        <input 
          class="form-input"
          maxlength="18"
          placeholder="18位身份证号码"
          value="{{form.idCard}}"
          bindinput="onIdCardInput"
        />
      </view>
    </view>
  </view>

  <!-- 签约信息（放在种植地址之前） -->
  <view class="form-section">
    <view class="section-header">
      <view class="section-indicator section-indicator-orange"></view>
      <text class="section-title">签约信息</text>
    </view>
    
    <view class="form-card">
      <!-- 种植面积 - 使用 stepper + input 组合 -->
      <view class="form-item">
        <text class="form-label required">种植面积（亩）</text>
        <view class="stepper-input-row">
          <input 
            class="stepper-input"
            type="digit"
            placeholder="0"
            value="{{form.acreage}}"
            bindinput="onAcreageInput"
          />
          <view class="stepper-controls">
            <view class="stepper-btn stepper-btn-minus" bindtap="onAcreageMinus">
              <t-icon name="remove" size="36rpx" color="{{form.acreage > 0 ? '#059669' : '#d1d5db'}}" />
            </view>
            <view class="stepper-btn stepper-btn-plus" bindtap="onAcreagePlus">
              <t-icon name="add" size="36rpx" color="#059669" />
            </view>
          </view>
        </view>
      </view>
      
      <view class="form-divider"></view>
      
      <!-- 农户等级 -->
      <view class="form-item">
        <text class="form-label required">农户等级</text>
        <view class="grade-tags">
          <view 
            class="grade-tag grade-tag-gold {{form.grade === 'gold' ? 'active' : ''}}"
            data-grade="gold"
            bindtap="onGradeTap"
          >
            <text>🥇 金牌</text>
          </view>
          <view 
            class="grade-tag grade-tag-silver {{form.grade === 'silver' ? 'active' : ''}}"
            data-grade="silver"
            bindtap="onGradeTap"
          >
            <text>🥈 银牌</text>
          </view>
          <view 
            class="grade-tag grade-tag-bronze {{form.grade === 'bronze' ? 'active' : ''}}"
            data-grade="bronze"
            bindtap="onGradeTap"
          >
            <text>🥉 铜牌</text>
          </view>
        </view>
      </view>
      
      <view class="form-divider"></view>
      
      <!-- 定金 - 使用 stepper + input 组合 -->
      <view class="form-item">
        <text class="form-label">定金（元）</text>
        <view class="stepper-input-row">
          <view class="deposit-input-wrapper">
            <text class="deposit-prefix">¥</text>
            <input 
              class="stepper-input deposit-input"
              type="digit"
              placeholder="0"
              value="{{form.deposit}}"
              bindinput="onDepositInput"
            />
          </view>
          <view class="stepper-controls">
            <view class="stepper-btn stepper-btn-minus" bindtap="onDepositMinus">
              <t-icon name="remove" size="36rpx" color="{{form.deposit > 0 ? '#ea580c' : '#d1d5db'}}" />
            </view>
            <view class="stepper-btn stepper-btn-plus" bindtap="onDepositPlus">
              <t-icon name="add" size="36rpx" color="#ea580c" />
            </view>
          </view>
        </view>
      </view>
      
      <view class="form-divider"></view>
      
      <!-- 种苗合计（万株）-->
      <view class="form-item">
        <text class="form-label">种苗合计（万株）</text>
        <view class="stepper-input-row">
          <input 
            class="stepper-input"
            type="digit"
            placeholder="0"
            value="{{form.seedTotal}}"
            bindinput="onSeedTotalInput"
          />
          <view class="stepper-controls">
            <view class="stepper-btn stepper-btn-minus" bindtap="onSeedTotalMinus">
              <t-icon name="remove" size="36rpx" color="{{form.seedTotal > 0 ? '#059669' : '#d1d5db'}}" />
            </view>
            <view class="stepper-btn stepper-btn-plus" bindtap="onSeedTotalPlus">
              <t-icon name="add" size="36rpx" color="#059669" />
            </view>
          </view>
        </view>
      </view>
      
      <view class="form-divider"></view>
      
      <!-- 单价（元/万株）-->
      <view class="form-item">
        <text class="form-label">单价（元/万株）</text>
        <view class="stepper-input-row">
          <view class="deposit-input-wrapper">
            <text class="deposit-prefix">¥</text>
            <input 
              class="stepper-input deposit-input"
              type="digit"
              placeholder="0"
              value="{{form.seedUnitPrice}}"
              bindinput="onSeedUnitPriceInput"
            />
          </view>
          <view class="stepper-controls">
            <view class="stepper-btn stepper-btn-minus" bindtap="onSeedUnitPriceMinus">
              <t-icon name="remove" size="36rpx" color="{{form.seedUnitPrice > 0 ? '#3b82f6' : '#d1d5db'}}" />
            </view>
            <view class="stepper-btn stepper-btn-plus" bindtap="onSeedUnitPricePlus">
              <t-icon name="add" size="36rpx" color="#3b82f6" />
            </view>
          </view>
        </view>
      </view>
      
      <view class="form-divider"></view>
      
      <!-- 应收款（自动计算）-->
      <view class="form-item">
        <text class="form-label">应收款（元）</text>
        <view class="readonly-value-row">
          <text class="readonly-prefix">¥</text>
          <text class="readonly-value">{{receivableAmount}}</text>
          <view class="auto-calc-tag">自动计算</view>
        </view>
      </view>
      
      <view class="form-divider"></view>
      
      <!-- 种苗欠款 -->
      <view class="form-item">
        <text class="form-label">种苗欠款（元）</text>
        <view class="stepper-input-row">
          <view class="deposit-input-wrapper">
            <text class="deposit-prefix">¥</text>
            <input 
              class="stepper-input deposit-input"
              type="digit"
              placeholder="0"
              value="{{form.seedDebt}}"
              bindinput="onSeedDebtInput"
            />
          </view>
          <view class="stepper-controls">
            <view class="stepper-btn stepper-btn-minus" bindtap="onSeedDebtMinus">
              <t-icon name="remove" size="36rpx" color="{{form.seedDebt > 0 ? '#ef4444' : '#d1d5db'}}" />
            </view>
            <view class="stepper-btn stepper-btn-plus" bindtap="onSeedDebtPlus">
              <t-icon name="add" size="36rpx" color="#ef4444" />
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>

  <!-- 种植地址（三级） -->
  <view class="form-section">
    <view class="section-header">
      <view class="section-indicator section-indicator-blue"></view>
      <text class="section-title">种植地址</text>
    </view>
    
    <view class="form-card">
      <view class="address-grid-three">
        <!-- 县/区 -->
        <view class="address-item">
          <text class="form-label required">县/区</text>
          <input 
            class="form-input"
            placeholder="输入县/区"
            value="{{form.county}}"
            bindinput="onCountyInput"
          />
        </view>
        
        <!-- 乡镇 -->
        <view class="address-item">
          <text class="form-label">乡镇</text>
          <input 
            class="form-input"
            placeholder="输入乡镇"
            value="{{form.township}}"
            bindinput="onTownshipInput"
          />
        </view>
        
        <!-- 村 -->
        <view class="address-item">
          <text class="form-label required">村</text>
          <input 
            class="form-input"
            placeholder="输入村"
            value="{{form.village}}"
            bindinput="onVillageInput"
          />
        </view>
      </view>
    </view>
  </view>

  <!-- 负责人信息 -->
  <view class="form-section">
    <view class="section-header">
      <view class="section-indicator section-indicator-purple"></view>
      <text class="section-title">负责人信息</text>
    </view>
    
    <view class="form-card">
      <!-- 第一负责人 -->
      <view class="form-item">
        <text class="form-label required">第一负责人</text>
        <input 
          class="form-input"
          placeholder="输入第一负责人姓名"
          value="{{firstManager}}"
          bindinput="onFirstManagerInput"
        />
      </view>
      
      <view class="form-divider"></view>
      
      <!-- 第二负责人 -->
      <view class="form-item">
        <text class="form-label">第二负责人</text>
        <input 
          class="form-input"
          placeholder="输入第二负责人姓名（可选）"
          value="{{secondManager}}"
          bindinput="onSecondManagerInput"
        />
      </view>
    </view>
  </view>

  <!-- 提示信息 -->
  <view class="tips">
    <text>* 标记为必填项，确认保存后该农户将进入系统管理。</text>
  </view>

  <!-- 底部按钮 -->
  <view class="bottom-actions">
    <button class="btn btn-cancel" bindtap="onCancel">取消</button>
    <button 
      class="btn btn-submit" 
      bindtap="onSubmit"
      loading="{{submitting}}"
    >确认签约</button>
  </view>
</view>
