<!--
  登录页面
  手机号验证码登录
-->
<view class="login-page">
  <!-- 装饰背景 -->
  <view class="bg-decoration">
    <view class="bg-circle bg-circle-1"></view>
    <view class="bg-circle bg-circle-2"></view>
  </view>

  <!-- 主内容区 -->
  <view class="login-content">
    <!-- Logo 和标题 -->
    <view class="login-header">
      <view class="logo-wrapper">
        <t-icon name="shop" size="80rpx" color="#ffffff" />
      </view>
      <view class="app-title">普惠农户 CRM</view>
      <view class="app-subtitle">智慧农业 · 数据驱动 · 便捷管理</view>
    </view>

    <!-- 登录表单 -->
    <view class="login-form">
      <view class="form-card">
        <!-- 手机号输入 -->
        <view class="input-group">
          <view class="input-icon">
            <t-icon name="mobile" size="40rpx" color="#059669" />
          </view>
          <input 
            class="input-field"
            type="number"
            maxlength="11"
            placeholder="请输入手机号"
            placeholder-class="input-placeholder"
            value="{{phone}}"
            bindinput="onPhoneInput"
          />
        </view>

        <!-- 分割线 -->
        <view class="input-divider"></view>

        <!-- 验证码输入 -->
        <view class="input-group">
          <view class="input-icon">
            <t-icon name="secured" size="40rpx" color="#059669" />
          </view>
          <input 
            class="input-field"
            type="number"
            maxlength="6"
            placeholder="请输入验证码"
            placeholder-class="input-placeholder"
            value="{{code}}"
            bindinput="onCodeInput"
          />
          <view 
            class="code-btn {{countdown > 0 || sending ? 'code-btn-disabled' : ''}}"
            bindtap="sendCode"
          >
            <text wx:if="{{sending}}">发送中...</text>
            <text wx:elif="{{countdown > 0}}">{{countdown}}s</text>
            <text wx:else>获取验证码</text>
          </view>
        </view>
      </view>

      <!-- 协议勾选 -->
      <view class="agreement-row" bindtap="toggleAgreement">
        <view class="checkbox {{agreed ? 'checkbox-checked' : ''}}">
          <t-icon wx:if="{{agreed}}" name="check" size="24rpx" color="#ffffff" />
        </view>
        <view class="agreement-text">
          <text>我已阅读并同意</text>
          <text class="agreement-link" catchtap="viewUserAgreement">《用户协议》</text>
          <text>和</text>
          <text class="agreement-link" catchtap="viewPrivacyPolicy">《隐私政策》</text>
        </view>
      </view>

      <!-- 登录按钮 -->
      <view class="login-btn-wrapper">
        <button 
          class="login-btn"
          bindtap="handleLogin"
          loading="{{logging}}"
        >
          <text>登录系统</text>
          <t-icon wx:if="{{!logging}}" name="chevron-right" size="40rpx" color="#ffffff" />
        </button>
      </view>
    </view>

  </view>

  <!-- Toast 提示 -->
  <t-toast 
    id="t-toast" 
    visible="{{toastVisible}}" 
    message="{{toastMessage}}"
    theme="text"
    direction="column"
    bind:close="onToastClose"
  />
</view>

