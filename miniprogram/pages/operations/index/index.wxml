<!--
  发苗管理页面（助理）
  显示农户发苗进度和发放记录
-->
<view class="seed-page">
  <!-- 页面头部 -->
  <view class="page-header">
    <view class="header-content">
      <text class="header-title">发苗管理</text>
      <text class="header-subtitle">查看农户发苗进度</text>
    </view>
  </view>

  <!-- 状态筛选标签 -->
  <view class="status-tabs">
    <view 
      class="status-tab {{farmerStatusFilter === 'all' ? 'active' : ''}}"
      data-status="all"
      bindtap="onStatusFilterChange"
    >
      <text>全部</text>
      <text class="tab-count">{{farmerStatusStats.all}}</text>
    </view>
    <view 
      class="status-tab {{farmerStatusFilter === 'pending' ? 'active' : ''}}"
      data-status="pending"
      bindtap="onStatusFilterChange"
    >
      <text>未发苗</text>
      <text class="tab-count">{{farmerStatusStats.pending}}</text>
    </view>
    <view 
      class="status-tab {{farmerStatusFilter === 'inProgress' ? 'active' : ''}}"
      data-status="inProgress"
      bindtap="onStatusFilterChange"
    >
      <text>发苗中</text>
      <text class="tab-count">{{farmerStatusStats.inProgress}}</text>
    </view>
    <view 
      class="status-tab {{farmerStatusFilter === 'completed' ? 'active' : ''}}"
      data-status="completed"
      bindtap="onStatusFilterChange"
    >
      <text>已完成</text>
      <text class="tab-count">{{farmerStatusStats.completed}}</text>
    </view>
  </view>

  <!-- 加载状态 -->
  <view wx:if="{{loading}}" class="loading-state">
    <t-loading theme="circular" size="40rpx" />
    <text>加载中...</text>
  </view>

  <!-- 农户列表 -->
  <view wx:else class="farmer-section">
    <view wx:if="{{filteredFarmers.length > 0}}" class="farmer-list">
      <view 
        wx:for="{{filteredFarmers}}" 
        wx:key="id" 
        class="farmer-card {{item.seedStatus}}"
        data-farmer="{{item}}"
        bindtap="onFarmerTap"
      >
        <view class="farmer-left">
          <view class="farmer-avatar">
            <text>{{item.name[0]}}</text>
          </view>
          <view class="farmer-info">
            <view class="farmer-name-row">
              <text class="farmer-name">{{item.name}}</text>
              <text class="status-tag status-{{item.seedStatus}}">
                {{item.seedStatus === 'completed' ? '已完成' : item.seedStatus === 'inProgress' ? '发苗中' : '未发苗'}}
              </text>
            </view>
            <text class="farmer-detail">{{item.acreage}}亩 · 签约{{item.seedTotal}}万株</text>
            <text wx:if="{{item.recordCount > 0}}" class="farmer-progress">
              已发{{item.recordCount}}次 · {{item.distributedQuantity}}万株
            </text>
          </view>
        </view>
        <view class="farmer-right">
          <t-icon name="chevron-right" size="40rpx" color="#d1d5db" />
        </view>
      </view>
    </view>

    <!-- 空状态 -->
    <view wx:else class="empty-state">
      <view class="empty-icon">
        <t-icon name="folder-open" size="80rpx" color="#d1d5db" />
      </view>
      <text class="empty-text">暂无农户</text>
    </view>
  </view>

  <!-- 底部添加按钮 -->
  <view class="add-btn-fixed" bindtap="onAddSeed">
    <t-icon name="add" size="44rpx" color="#ffffff" />
    <text>发苗登记</text>
  </view>

  <!-- 底部安全区 -->
  <view class="safe-bottom"></view>
</view>
